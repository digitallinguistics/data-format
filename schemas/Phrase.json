{

  "$schema": "http://json-schema.org/schema#",
  "id": "http://cdn.digitallinguistics.io/schemas/Phrase-1.0.0-alpha.1.json",

  "title": "Phrase",
  "type": "object",
  "description": "The term *phrase* is intentially ambiguous, and refers to any unit of a text above the word level. The DLx framework imposes no requirements regarding this size of this unit or how segmentation of the text into units should be accomplished. The user may choose to segment a text based on intonation units, turns, sentences, or any other appropriate subdivision. A DLx phrase consists minimally of a transcription, a translation, and an array of words (though the words array may be empty).",

  "required": [
    "transcription",
    "translation",
    "words"
  ],

  "dependencies": {
    "startTime": ["endTime"],
    "endTime": ["startTime"]
  },

  "additionalProperties": true,

  "properties": {

    "endTime": {
      "title": "End Time",
      "type": "number",
      "description": "The time that the speaker finishes producing this phrase within the media file(s) associated with this Text. The timestamp should be formatted in SS.MMM (seconds and milliseconds)."
    },

    "key": {
      "title": "Key",
      "type": "string",
      "description": "A key which uniquely identifies this phrase within the Text. The key for a phrase consists of the abbreviation of the text, a period, and then the number of this phrase within the text (index starts at 1). For example, the third phrase of a text with the abbreviation `A` would be `A.3`. Keys should be unique within a corpus.",
      "pattern": "^[(a-z)|(A-Z)|(0-9)]+\\.[0-9]{1,3}$"
    },

    "language": {
      "title": "Language",
      "type": "string",
      "description": "The key for the language used in this phrase, e.g. `spa` or `eng`. If the text is labeled with a language, all its phrases are assumed to be the same language unless labeled otherwise. Likewise, if a phrase is given a language, all its words are assumed to be the same language unless the word is labeled otherwise.",
      "$ref": "http://cdn.digitallinguistics.io/schemas/Abbreviation.json"
    },

    "notes": {

      "title": "Notes",
      "type": "array",
      "description": "A collection of notes about this Phrase.",

      "uniqueItems": true,

      "items": {
        "title": "Note",
        "description": "A note about this phrase, optionally in multiple orthographies.",
        "$ref": "http://cdn.digitallinguistics.io/schemas/Note.json"
      }

    },

    "speaker": {
      "title": "Speaker",
      "type": "string",
      "description": "The abbreviation of person who produced (uttered, signed, spoke, sung) this Phrase. The value of this field must match the abbreviation of one of the persons listed in the `contributors` array of the Text. If the text has a single contributor with the role of `speaker`, that speaker is assumed to be the speaker for all phrases in the Text. If multiple contributors with a `speaker` role are included in a text, each phrase must have its `speaker` attribute specified.",
      "$ref": "http://cdn.digitallinguistics.io/schemas/Abbreviation.json"
    },

    "startTime": {
      "title": "Start Time",
      "type": "number",
      "description": "The time that the speaker begins producing this phrase within the media file(s) associated with this Text. The timestamp should be formatted in SS.MMM (seconds and milliseconds)."
    },

    "tags": {
      "title": "Tags",
      "$ref": "http://cdn.digitallinguistics.io/schemas/Tags.json"
    },

    "transcription": {
      "title": "Transcription",
      "description": "The transcriptions for this phrase, optionally in multiple orthographies.",
      "$ref": "http://cdn.digitallinguistics.io/schemas/MultiLangString.json"
    },

    "translation": {
      "title": "Translation",
      "description": "The translations for this phrase, optionally in multiple orthographies. Also includes an optional `type` attribute, for specifying things like `free` or `literal` translation.",
      "allOf": [
        { "$ref": "http://cdn.digitallinguistics.io/schemas/MultiLangString.json"},
        {
          "properties": {
            "type": {
              "title": "Translation Type",
              "description": "The type of translation. Typical values are `free` or `literal`, but other values may be supplied.",
              "type": "string"
            }
          }
        }
      ]
    },

    "url": {
      "title": "URL",
      "description": "The URL where this phrase can be retrieved in JSON format.",
      "$ref": "http://cdn.digitallinguistics.io/schemas/Url.json"
    },

    "words": {
      "title": "Words",
      "type": "array",
      "description": "A collection of the word tokens contained in this Phrase.",
      "uniqueItems": false,
      "items": {
        "title": "Word",
        "$ref": "http://cdn.digitallinguistics.io/schemas/Word.json"
      }
    }

  }
}
